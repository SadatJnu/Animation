!function(C){C.fn.canvasAnimationEditor=function(o){var r=this,e=[],i=r.width().toFixed(0),d=r.height().toFixed(0),p="",m="",h=0,u=0;o=C.extend(!0,{},{enable:!1,decimal:2,draggableItems:!0,wrapper:".jca-editor-container",labels:{top:"top",left:"left",width:"width",height:"height",newItem:"New: ",newItemBlank:"Blank",newItemExt:"Extended",select:"Select: ",selectCss:"CSS",selectHtml:"HTML",remove:"Remove: ",removeItem:"Item",removeStyle:"Style",className:"CSS class name",parentWidth:"Parent width in px",parentHeight:"Parent height in px",itemWidth:"Item width in px",itemHeight:"Item height in px",itemTop:"Item offset top in px",itemLeft:"Item offset left in px",confirmAppendPrepend:"OK = append item / Cancel = prepend item",confirmRemoveItem:"Are you sure to remove item?",confirmRemoveStyle:"Are you sure to remove style?",alertCanvasId:'Canvas needs attribute "id".'},template:'<div class="jca-editor-container"><div class="jca-container"><div class="jca-col jca-cord-dimension"><div class="jca-box"><div class="jca-label jca-top"></div><div class="jca-label jca-left"></div><div class="jca-label jca-width"></div><div class="jca-label jca-height"></div><input type="number" step="0.01" name="jca_top" /><input type="number" step="0.01" name="jca_left" /><input type="number" step="0.01" name="jca_width" /><input type="number" step="0.01" name="jca_height" /></div></div><div class="jca-col jca-selector-breadcrumb"></div><div class="jca-col jca-code-col"><div id="jca-html"></div><div id="jca-css"></div></div><div class="jca-col jca-button-col"><span class="jca-new"></span><input type="button" name="jca_new_item" value=""/> <input type="button" name="jca_new_item_ext" value=""/><br/><span class="jca-select"></span><input type="button" name="jca_html" value=""/> <input type="button" name="jca_css" value=""/><br/><span class="jca-remove"></span><input type="button" name="jca_remove_item" value=""/> <input type="button" name="jca_remove_style" value=""/><br/><br/><span class="jca-width"></span> <span class="jca-width-val"></span> <span class="jca-height"></span> <span class="jca-height-val"></span><br/><span class="jca-top"></span> <span class="jca-top-val"></span> <span class="jca-left"></span> <span class="jca-left-val"></span></div></div></div>'},o);if("undefined"!==r.attr("id")){C("html").addClass("jca-editor-enable");var a=C(o.template);a.find(".jca-label.jca-top").attr("data-label",o.labels.top),a.find(".jca-label.jca-left").attr("data-label",o.labels.left),a.find(".jca-label.jca-width").attr("data-label",o.labels.width),a.find(".jca-label.jca-height").attr("data-label",o.labels.height),a.find(".jca-button-col .jca-top").text(o.labels.top+":"),a.find(".jca-button-col .jca-left").text(o.labels.left+":"),a.find(".jca-button-col .jca-width").text(o.labels.width+":"),a.find(".jca-button-col .jca-height").text(o.labels.height+":"),a.find('[name="jca_new_item"]').val(o.labels.newItemBlank),a.find('[name="jca_new_item_ext"]').val(o.labels.newItemExt),a.find('[name="jca_css"]').val(o.labels.selectCss),a.find('[name="jca_html"]').val(o.labels.selectHtml),a.find('[name="jca_remove_item"]').val(o.labels.removeItem),a.find('[name="jca_remove_style"]').val(o.labels.removeStyle),a.find(".jca-new").text(o.labels.newItem),a.find(".jca-select").text(o.labels.select),a.find(".jca-remove").text(o.labels.remove),r.parent().append(a),o.decimal<1&&(o.decimal=2),a.find('[name="jca_top"]').attr("step",1/Math.pow(10,o.decimal)),a.find('[name="jca_left"]').attr("step",1/Math.pow(10,o.decimal)),a.find('[name="jca_width"]').attr("step",1/Math.pow(10,o.decimal)),a.find('[name="jca_height"]').attr("step",1/Math.pow(10,o.decimal)),r.attr("data-hash",j()),C(".jca-selector-breadcrumb").html(c(r)),l(r),C("*",r).each(function(){C(this).attr("data-hash",j()),C(this).attr("data-class",C(this).attr("class")),b(C(this))}),C(r).click(function(a){var e=C(a.target);r.hide(),C("*",r).removeClass("jca-active-element"),C("*",r).css("background-color",""),x(e)?(C('[name="jca_top"]').val(""),C('[name="jca_left"]').val(""),C('[name="jca_width"]').val(""),C('[name="jca_height"]').val(""),C("#jca-css").html(""),C("#jca-html").html("")):(C('[name="jca_top"]').val(parseFloat(e.css("top"))),C('[name="jca_left"]').val(parseFloat(e.css("left"))),C('[name="jca_width"]').val(parseFloat(e.css("width"))),C('[name="jca_height"]').val(parseFloat(e.css("height"))),e.addClass("jca-active-element"),e.css("background-color",v()),C("#jca-css").html(s(e)),C("#jca-html").html(n(e))),r.show(),C(".jca-selector-breadcrumb").html(c(e)),l(e),i=e.width().toFixed(0),d=e.height().toFixed(0),x(e)||b(e)}),C(".jca-cord-dimension input").change(function(){w()}),C(".jca-cord-dimension input").keyup(function(){w()}),C('[name="jca_new_item"]').click(function(){f(prompt(o.labels.className),"0","0","25%","25%")}),C('[name="jca_new_item_ext"]').click(function(){var a=prompt(o.labels.className),e=i=parseInt(prompt(o.labels.parentWidth,i)),t=d=parseInt(prompt(o.labels.parentHeight,d)),s=m=parseInt(prompt(o.labels.itemWidth,m)),n=p=parseInt(prompt(o.labels.itemHeight,p)),c=h=parseInt(prompt(o.labels.itemTop,h)),l=u=parseInt(prompt(o.labels.itemLeft,u));f(a,(100*c/t).toFixed(o.decimal)+"%",(100*l/e).toFixed(o.decimal)+"%",(100*s/e).toFixed(o.decimal)+"%",(100*n/t).toFixed(o.decimal)+"%")}),C('[name="jca_remove_item"]').click(function(){if(C(".jca-active-element").length&&confirm(o.labels.confirmRemoveItem+" "+t(C(".jca-active-element")))){var a=C(".jca-active-element").parent();C(".jca-active-element").remove(),a.click()}}),C('[name="jca_remove_style"]').click(function(){C(".jca-active-element").length&&confirm(o.labels.confirmRemoveStyle+" "+t(C(".jca-active-element")))&&C(".jca-active-element").attr("style","")}),C('[name="jca_css"]').click(function(){g("jca-css")}),C('[name="jca_html"]').click(function(){g("jca-html")}),C(".jca-selector-breadcrumb").on("click","a",function(a){a.preventDefault(),C('[data-hash="'+C(this).attr("href")+'"]').click()})}else alert(o.labels.alertCanvasId);function f(a,e,t,s,n){var c=C('<div class="'+a+'" data-class="'+a+'"></div>');c.css("position","absolute"),c.css("top",e),c.css("left",t),c.css("width",s),c.css("height",n),c.attr("data-hash",j()),c.css("background-color",v());var l='[data-hash="'+c.attr("data-hash")+'"]';if(C("head").append("<style>"+l+"{background-color:"+v()+"}</style>"),a.length){if(C(".jca-active-element").length)var i=C(".jca-active-element");else i=r;confirm(o.labels.confirmAppendPrepend)?i.append(c):i.prepend(c),C(l).click()}b(C(l))}function s(a){var e=t(a)+" {<br/>";return e+="&nbsp;&nbsp;&nbsp;&nbsp;top: "+a.css("top")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;left: "+a.css("left")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;width: "+a.css("width")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;height: "+a.css("height")+";<br>",e+="}"}function n(a){return('<div class="'+a.data("class")+'"></div>').replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function t(a){var e=(a=a.clone()).attr("id"),t=a.data("class"),s="";return void 0!==e&&e.length&&(s+="#"+e),void 0!==t&&t.length&&(s+="."+t.replace(/ /gi,".")),s}function v(){for(var a="#",e=0;e<6;e++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a}function c(a){var e="";return x(a)||(e=c(a.parent())),e+'<a href="'+a.data("hash")+'">'+t(a)+'</a> <span class="jca-pointer">></span> '}function j(){for(var a="";a=v(),-1<e.indexOf(a););return e.push(a),a}function l(a){x(a)?(C(".jca-button-col .jca-top-val").text("0px;"),C(".jca-button-col .jca-left-val").text("0px;")):(C(".jca-button-col .jca-top-val").text(parseInt(a.css("top")).toFixed(0)+"px;"),C(".jca-button-col .jca-left-val").text(parseInt(a.css("left")).toFixed(0)+"px;")),C(".jca-button-col .jca-width-val").text(a.width().toFixed(0)+"px;"),C(".jca-button-col .jca-height-val").text(a.height().toFixed(0)+"px;")}function b(t){o.draggableItems&&"function"==typeof C.fn.draggable&&!t.hasClass("ui-draggable")&&t.draggable({stop:function(a,e){C("*",r).removeClass("jca-active-element"),t.css("top",(100*parseFloat(t.css("top"))/t.parent().height()).toFixed(o.decimal)+"%"),t.css("left",(100*parseFloat(t.css("left"))/t.parent().width()).toFixed(o.decimal)+"%"),C('[name="jca_top"]').val((100*parseFloat(t.css("top"))/t.parent().height()).toFixed(o.decimal)),C('[name="jca_left"]').val((100*parseFloat(t.css("left"))/t.parent().width()).toFixed(o.decimal)),r.hide(),C('[name="jca_width"]').val(parseFloat(t.css("width"))),C('[name="jca_height"]').val(parseFloat(t.css("height"))),C("#jca-css").html(s(t)),C("#jca-html").html(n(t)),r.show(),C(".jca-selector-breadcrumb").html(c(t)),l(t),C(e.helper).hasClass("jca-active-element")||C(e.helper).addClass("jca-active-element")}})}function w(){if(C(".jca-active-element").length){var a=C(".jca-active-element");a.css("top",C('[name="jca_top"]').val()+"%"),a.css("left",C('[name="jca_left"]').val()+"%"),a.css("width",C('[name="jca_width"]').val()+"%"),a.css("height",C('[name="jca_height"]').val()+"%"),r.hide(),C("#jca-css").html(s(a)),r.show(),l(a)}else C('[name="jca_top"]').val(""),C('[name="jca_left"]').val(""),C('[name="jca_width"]').val(""),C('[name="jca_height"]').val(""),l(r)}function g(a){var e,t,s=document,n=s.getElementById(a);s.body.createTextRange?((e=document.body.createTextRange()).moveToElementText(n),e.select()):window.getSelection&&(t=window.getSelection(),(e=document.createRange()).selectNodeContents(n),t.removeAllRanges(),t.addRange(e))}function x(a){return void 0!==a.attr("id")&&a.attr("id")===r.attr("id")}}}(jQuery),function(m){m.fn.canvasAnimation=function(n){if("undefined"!==this.attr("id")){var e,c=this,l=[],i=-1,a=(n=m.extend(!0,{},{steps:[],timeout:0,resetDuration:500,infinite:!0,autoplay:!0,controls:!0,editor:{enable:!1,wrapper:".jca-editor-container"},useIcons:!1,icons:{backward:'<i class="fas fa-step-backward"></i>',play:'<i class="fas fa-play"></i>',pause:'<i class="fas fa-pause"></i>',stop:'<i class="fas fa-stop"></i>',forward:'<i class="fas fa-step-forward"></i>',expand:'<i class="fas fa-expand"></i>',editor:'<i class="fas fa-edit"></i>'},controlsWrapper:".jca-controls",backwardButton:".jca-backward",playButton:".jca-play",pauseButton:".jca-pause",stopButton:".jca-stop",forwardButton:".jca-forward",expandButton:".jca-expand",editorButton:".jca-editor",classDone:"jca-done",classWait:"jca-wait",classForward:"jca-forward",classBackward:"jca-backward",classWrap:"jca-wrap",controlsTemplate:'<div class="jca-controls"><div class="jca-backward"></div><div class="jca-play"></div><div class="jca-pause"></div><div class="jca-stop"></div><div class="jca-forward"></div><div class="jca-expand"></div><div class="jca-editor"></div></div>',onPlay:null,onDone:null,onWait:null},n)).infinite,t=m(n.controlsTemplate);n.editor.enable=n.editor.enable&&"function"==typeof m.fn.canvasAnimationEditor,c.wrap('<div class="'+n.classWrap+'"></div>'),n.useIcons&&(m("html").addClass("jca-icons"),t.find(n.backwardButton).append(n.icons.backward),t.find(n.playButton).append(n.icons.play),t.find(n.pauseButton).append(n.icons.pause),t.find(n.stopButton).append(n.icons.stop),t.find(n.forwardButton).append(n.icons.forward),t.find(n.expandButton).append(n.icons.expand),t.find(n.editorButton).append(n.icons.editor)),n.controls&&(n.editor.enable||t.find(n.editorButton).remove(),c.closest("."+n.classWrap).append(t.clone()));var o=function(a){a&&a()},s=function(){var s=n.timeout;l=[],c.hasClass(n.classDone)&&d(),c.hasClass(n.classForward)&&i--,c.hasClass(n.classDone)&&(c.removeClass(n.classDone),s+=n.resetDuration),c.removeClass(n.classWait),o(n.onPlay),m.each(n.steps,function(a,e){if(i<a){var t=setTimeout(function(){i=a,c.addClass(e.addClass),c.removeClass(e.removeClass),"boolean"==typeof e.pause&&!0===e.pause&&(n.infinite=!1,p(!1)),n.steps.length-1===a&&r(e.duration)},s);"number"!=typeof e.duration&&(e.duration=500),s+=e.duration,l.push(t)}})},r=function(a){e=setTimeout(function(){c.addClass(n.classDone),c.hasClass(n.classWait)||(n.infinite?s():o(n.onDone))},a)},d=function(){m.each(n.steps,function(a,e){c.removeClass(e.addClass)}),i=-1},p=function(a){0<l.length&&(m.each(l,function(a,e){clearTimeout(l[a])}),a&&d(),c.addClass(n.classWait),o(n.onWait),void 0!==e&&clearTimeout(e))};n.autoplay?s():(c.addClass(n.classWait),o(n.onWait)),n.editor.enable||c.click(function(){n.infinite=a,(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&s()}),c.next(n.controlsWrapper).find(n.backwardButton).click(function(){(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&(c.hasClass(n.classForward)&&i--,c.removeClass(n.classForward),c.addClass(n.classBackward),i<0&&(i=n.steps.length),i===n.steps.length?m.each(n.steps,function(a,e){c.addClass(e.addClass),c.removeClass(e.removeClass)}):(c.removeClass(n.steps[i].addClass),c.addClass(n.steps[i].removeClass)),i--)}),c.next(n.controlsWrapper).find(n.playButton).click(function(){n.infinite=a,(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&s()}),c.next(n.controlsWrapper).find(n.pauseButton).click(function(){n.infinite=!1,p(!1)}),c.next(n.controlsWrapper).find(n.stopButton).click(function(){n.infinite=!1,p(!0),d(),c.removeClass(n.classDone),c.addClass(n.classWait),o(n.onWait)}),c.next(n.controlsWrapper).find(n.forwardButton).click(function(){(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&(c.hasClass(n.classBackward)&&i++,c.addClass(n.classForward),c.removeClass(n.classBackward),(i>n.steps.length||-1===i)&&(i=0),i===n.steps.length?d():(c.addClass(n.steps[i].addClass),c.removeClass(n.steps[i].removeClass)),i++)}),c.next(n.controlsWrapper).find(n.expandButton).click(function(){var a;(a=c[0]).requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}),n.editor.enable&&(c.canvasAnimationEditor(n.editor),c.next(n.controlsWrapper).find(n.editorButton).click(function(){m(n.editor.wrapper).is(":visible")?m(n.editor.wrapper).hide():m(n.editor.wrapper).show()}))}}}(jQuery);